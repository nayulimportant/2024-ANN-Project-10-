%load_ext tensorboard

import numpy as np
import tensorflow as tf
import matplotlib.pyplot as plt

from tensorflow import keras
from tensorflow.keras import Model
from tensorflow.keras.models import Sequential
from tensorflow.keras.utils import to_categorical
from tensorflow.keras.losses import categorical_crossentropy
from tensorflow.keras.preprocessing.image import ImageDataGenerator
from tensorflow.keras.layers import Dense, Flatten, Conv2D, AveragePooling2D, Dropout
from tensorflow.keras.callbacks import EarlyStopping

## 모델 정의 ##
tf.random.set_seed(42)
np.random.seed(42)

modelL = keras.models.Sequential([
    keras.layers.Conv2D(6, kernel_size=(5,5), strides=(1,1), activation='relu',
                    input_shape=[28, 28, 1], padding="same"),
    keras.layers.AveragePooling2D(pool_size=(2,2), strides=(2,2),padding='valid'),
    keras.layers.Conv2D(16, kernel_size=(5,5), strides=(1,1), activation='relu',
                    padding='valid'),
    keras.layers.AveragePooling2D(pool_size=(2,2), strides=(2,2), padding='valid'),
    keras.layers.Flatten(),
    keras.layers.Dense(120, activation='relu'),
    keras.layers.Dense(84, activation='relu'),
    keras.layers.Dense(47, activation='softmax')
])

modelL.summary()   
